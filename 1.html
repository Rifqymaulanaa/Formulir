<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Formulir Pemesanan Profesional</title>
    <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-100 flex items-center justify-center min-h-screen">

    <div class="w-full max-w-lg p-8 space-y-6 bg-white rounded-xl shadow-lg">
        <h2 class="text-3xl font-bold text-center text-gray-900">
            Formulir Pemesanan
        </h2>

        <div id="responseMessage" class="hidden text-center p-3 rounded-md"></div>

        <form id="orderForm" class="space-y-5">
            
            <div>
                <label for="nama" class="block text-sm font-medium text-gray-700">Nama Lengkap</label>
                <input type="text" id="nama" name="nama" 
                       class="w-full px-4 py-3 mt-1 text-gray-800 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="Contoh: Budi Santoso" required>
            </div>

            <div>
                <label for="telepon" class="block text-sm font-medium text-gray-700">Nomor Telepon (WhatsApp)</label>
                <input type="tel" id="telepon" name="telepon" 
                       class="w-full px-4 py-3 mt-1 text-gray-800 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                       placeholder="Contoh: 08123456789" required>
            </div>

            <div class="flex flex-col md:flex-row md:space-x-4 space-y-5 md:space-y-0">
                <div class="w-full md:w-1/2">
                    <label for="jumlah" class="block text-sm font-medium text-gray-700">Jumlah Pesanan</label>
                    <input type="number" id="jumlah" name="jumlah" 
                           class="w-full px-4 py-3 mt-1 text-gray-800 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                           min="1" placeholder="Min. 1" required>
                </div>
                
                <div class="w-full md:w-1/2">
                    <label for="produk" class="block text-sm font-medium text-gray-700">Pilih Produk</label>
                    <select id="produk" name="produk" 
                            class="w-full px-4 py-3 mt-1 text-gray-800 bg-white border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                            required>
                        <option value="" disabled selected>Pilih salah satu...</option>
                        <option value="Produk A">Produk A</option>
                        <option value="Produk B">Produk B</option>
                        <option value="Produk C">Produk C</option>
                        <option value="Lainnya">Lainnya</option>
                    </select>
                </div>
            </div>

            <div id="loader" class="hidden flex justify-center items-center">
                <svg class="animate-spin h-5 w-5 text-blue-600" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24">
                    <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                    <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
                </svg>
                <span class="ml-2 text-gray-600">Mengirim...</span>
            </div>

            <div>
                <button type="submit" id="submitButton"
                        class="w-full px-4 py-3 font-semibold text-white bg-blue-600 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-2 transition-colors duration-300">
                    Kirim Pesanan
                </button>
            </div>
        </form>
    </div>

    <script>
        const form = document.getElementById('orderForm');
        const submitButton = document.getElementById('submitButton');
        const loader = document.getElementById('loader');
        const responseMessage = document.getElementById('responseMessage');

        // URL Web App Google Apps Script Anda akan ditempel di sini
        const WEB_APP_URL = 'https://script.google.com/macros/s/AKfycbyTQ8cMMk0iC5N_q2F-q4qM6AjIksu1W0bS_TCkU1NVfe0kQJhV2SsnD0LeDwzfnX58/exec';

        form.addEventListener('submit', async (e) => {
            e.preventDefault(); // Mencegah submit form standar

            // Validasi Sederhana Sisi Klien
            const nama = document.getElementById('nama').value;
            const telepon = document.getElementById('telepon').value;
            const jumlah = document.getElementById('jumlah').value;
            const produk = document.getElementById('produk').value;

            if (!nama || !telepon || !jumlah || !produk) {
                showMessage('Semua field wajib diisi.', 'error');
                return;
            }

            if (parseInt(jumlah) < 1) {
                showMessage('Jumlah pesanan minimal 1.', 'error');
                return;
            }

            // Menampilkan status loading
            submitButton.disabled = true;
            submitButton.classList.add('opacity-50', 'cursor-not-allowed');
            loader.classList.remove('hidden');
            responseMessage.classList.add('hidden'); // Sembunyikan pesan lama

            const formData = new FormData(form);

            try {
                const response = await fetch(WEB_APP_URL, {
                    method: 'POST',
                    body: formData
                });

                const result = await response.json();

                if (result.status === 'success') {
                    // Sukses
                    showMessage(result.message, 'success');
                    form.reset(); // Reset form setelah berhasil
                } else {
                    // Error dari server (Apps Script)
                    throw new Error(result.message);
                }
            } catch (error) {
                // Error jaringan atau lainnya
                console.error('Error submitting form:', error);
                showMessage(error.message || 'Gagal mengirim data. Silakan coba lagi.', 'error');
            } finally {
                // Mengembalikan UI ke status normal
                submitButton.disabled = false;
                submitButton.classList.remove('opacity-50', 'cursor-not-allowed');
                loader.classList.add('hidden');
            }
        });

        function showMessage(message, type) {
            responseMessage.textContent = message;
            if (type === 'success') {
                responseMessage.className = 'p-3 rounded-md text-center text-green-800 bg-green-100';
            } else {
                responseMessage.className = 'p-3 rounded-md text-center text-red-800 bg-red-100';
            }
            responseMessage.classList.remove('hidden');
        }
    </script>

</body>
</html>
